<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="سعید گلستانی">
    <title>محاسبه‌گر بهینه‌سازی برش کویل ورق</title>
    <style>
        body {
            font-family: 'Vazirimath', sans-serif;
            margin: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 30px;
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 15px;
            font-size: 2.2em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .author-section {
            text-align: center;
            margin-bottom: 20px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }
        
        .author-section p {
            color: #495057;
            font-size: 1.1em;
            margin: 0;
        }
        
        .input-section, .results-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #e9ecef;
        }
        
        .input-section h2, .results-section h2 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .input-item {
            display: flex;
            flex-direction: column;
        }
        
        label {
            margin-bottom: 5px;
            font-weight: bold;
            color: #495057;
        }
        
        input {
            padding: 10px;
            border: 2px solid #ced4da;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .calculate-btn {
            font-family: 'Vazirimath', sans-serif;
			background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            display: block;
            margin: 20px auto;
        }
        
        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .result-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }
        
        .result-card h3 {
            color: #495057;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .result-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }
        
        .cutting-diagram {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .diagram-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-top: 10px;
        }
        
        .coil-visualization {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .coil-row {
            display: flex;
            gap: 2px;
        }
        
        .sheet-piece {
            width: 30px;
            height: 20px;
            background: linear-gradient(45deg, #28a745, #20c997);
            border: 1px solid #1e7e34;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: white;
            font-weight: bold;
        }
        
        .waste-area {
            background: linear-gradient(45deg, #dc3545, #fd7e14);
            opacity: 0.7;
        }
        
        .optimize-info {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            border-left: 4px solid #17a2b8;
        }
        
        .optimize-info h4 {
            color: #0c5460;
            margin-bottom: 10px;
        }
        
        .optimize-info p {
            color: #0c5460;
            margin: 5px 0;
        }
        
        .instructions {
            background: #fff3cd;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #ffc107;
        }
        
        .instructions h3 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .instructions ul {
            color: #856404;
            margin: 10px 0;
            padding-right: 20px;
        }
        
        .instructions li {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>محاسبه‌گر بهینه‌سازی برش کویل ورق</h1>
        <div class="author-section">
            <p>نویسنده: سعید گلستانی</p>
        </div>
        
        <div class="instructions">
            <h3>راهنمای استفاده:</h3>
            <ul>
                <li>وزن کویل را به کیلوگرم وارد کنید</li>
                <li>عرض کویل را به میلی‌متر وارد کنید</li>
                <li>ضخامت کویل را به میلی‌متر وارد کنید</li>
                <li>ابعاد ورق مورد نیاز را به متر وارد کنید</li>
                <li>دکمه محاسبه را فشار دهید</li>
            </ul>
        </div>
        
        <div class="input-section">
            <h2>مشخصات کویل اصلی</h2>
            <div class="input-group">
                <div class="input-item">
                    <label for="coilWeight">وزن کویل (کیلوگرم):</label>
                    <input type="number" id="coilWeight" step="0.1" placeholder="مثال: 1000">
                </div>
                <div class="input-item">
                    <label for="coilWidth">عرض کویل (میلی‌متر):</label>
                    <input type="number" id="coilWidth" step="0.1" placeholder="مثال: 1250">
                </div>
                <div class="input-item">
                    <label for="coilThickness">ضخامت کویل (میلی‌متر):</label>
                    <input type="number" id="coilThickness" step="0.01" placeholder="مثال: 0.5">
                </div>
                <div class="input-item">
                    <label for="density">دانسیته (گرم/سانتی‌متر مکعب):</label>
                    <input type="number" id="density" value="7.85" step="0.01" readonly>
                </div>
            </div>
        </div>
        
        <div class="input-section">
            <h2>ابعاد ورق مورد نیاز</h2>
            <div class="input-group">
                <div class="input-item">
                    <label for="sheetLength">طول ورق (متر):</label>
                    <input type="number" id="sheetLength" step="0.01" placeholder="مثال: 2.5">
                </div>
                <div class="input-item">
                    <label for="sheetWidth">عرض ورق (متر):</label>
                    <input type="number" id="sheetWidth" step="0.01" placeholder="مثال: 1.2">
                </div>
            </div>
        </div>
        
        <button class="calculate-btn" onclick="calculateOptimization()">محاسبه بهینه‌سازی</button>
        
        <div class="results-section" id="resultsSection" style="display: none;">
            <h2>نتایج محاسبات</h2>
            <div class="results-grid">
                <div class="result-card">
                    <h3>طول کویل محاسبه شده</h3>
                    <div class="result-value" id="coilLength">-</div>
                </div>
                <div class="result-card">
                    <h3>تعداد ورق قابل تولید</h3>
                    <div class="result-value" id="sheetsCount">-</div>
                </div>
                <div class="result-card">
                    <h3>درصد ضایعات</h3>
                    <div class="result-value" id="wastePercentage">-</div>
                </div>
                <div class="result-card">
                    <h3>مساحت مفید</h3>
                    <div class="result-value" id="usefulArea">-</div>
                </div>
            </div>
            
            <div class="cutting-diagram">
                <h3>نحوه برش بهینه</h3>
                <div class="optimize-info">
                    <h4>توصیه‌های برش:</h4>
                    <p id="cuttingDirection">-</p>
                    <p id="cuttingPattern">-</p>
                    <p id="optimizationTips">-</p>
                </div>
                <div class="diagram-container" id="diagramContainer">
                    <!-- نمودار برش اینجا نمایش داده می‌شود -->
                </div>
            </div>
        </div>
    </div>

    <script>
        function calculateOptimization() {
            // دریافت مقادیر ورودی
            const coilWeight = parseFloat(document.getElementById('coilWeight').value);
            const coilWidth = parseFloat(document.getElementById('coilWidth').value);
            const coilThickness = parseFloat(document.getElementById('coilThickness').value);
            const density = parseFloat(document.getElementById('density').value);
            const sheetLength = parseFloat(document.getElementById('sheetLength').value);
            const sheetWidth = parseFloat(document.getElementById('sheetWidth').value);

            // بررسی صحت داده‌ها
            if (!coilWeight || !coilWidth || !coilThickness || !sheetLength || !sheetWidth) {
                alert('لطفاً تمام فیلدها را پر کنید');
                return;
            }

            // محاسبه طول کویل
            // وزن = حجم × دانسیته
            // حجم = طول × عرض × ضخامت
            // طول = وزن / (عرض × ضخامت × دانسیته)
            
            const coilWidthCm = coilWidth / 10; // تبدیل میلی‌متر به سانتی‌متر
            const coilThicknessCm = coilThickness / 10; // تبدیل میلی‌متر به سانتی‌متر
            const coilWeightGram = coilWeight * 1000; // تبدیل کیلوگرم به گرم
            
            const coilLengthCm = coilWeightGram / (coilWidthCm * coilThicknessCm * density);
            const coilLengthM = coilLengthCm / 100; // تبدیل به متر

            // تبدیل ابعاد به میلی‌متر برای محاسبه
            const sheetLengthMm = sheetLength * 1000;
            const sheetWidthMm = sheetWidth * 1000;

            // محاسبه بهینه‌سازی برش
            const coilLengthMm = coilLengthM * 1000;

            // دو حالت برش: طولی و عرضی
            // حالت 1: برش طولی (طول ورق در جهت طول کویل)
            const sheets1_length = Math.floor(coilLengthMm / sheetLengthMm);
            const sheets1_width = Math.floor(coilWidth / sheetWidthMm);
            const totalSheets1 = sheets1_length * sheets1_width;
            
            const usedArea1 = totalSheets1 * sheetLengthMm * sheetWidthMm;
            const totalArea1 = coilLengthMm * coilWidth;
            const waste1 = ((totalArea1 - usedArea1) / totalArea1) * 100;

            // حالت 2: برش عرضی (عرض ورق در جهت طول کویل)
            const sheets2_length = Math.floor(coilLengthMm / sheetWidthMm);
            const sheets2_width = Math.floor(coilWidth / sheetLengthMm);
            const totalSheets2 = sheets2_length * sheets2_width;
            
            const usedArea2 = totalSheets2 * sheetLengthMm * sheetWidthMm;
            const totalArea2 = coilLengthMm * coilWidth;
            const waste2 = ((totalArea2 - usedArea2) / totalArea2) * 100;

            // انتخاب بهترین حالت
            let bestOption, cuttingDirection, cuttingPattern;
            if (totalSheets1 >= totalSheets2) {
                bestOption = {
                    sheets: totalSheets1,
                    waste: waste1,
                    usedArea: usedArea1,
                    lengthSheets: sheets1_length,
                    widthSheets: sheets1_width
                };
                cuttingDirection = 'برش طولی (طول ورق در جهت طول کویل)';
                cuttingPattern = `تعداد ورق در طول: ${sheets1_length} - تعداد ورق در عرض: ${sheets1_width}`;
            } else {
                bestOption = {
                    sheets: totalSheets2,
                    waste: waste2,
                    usedArea: usedArea2,
                    lengthSheets: sheets2_length,
                    widthSheets: sheets2_width
                };
                cuttingDirection = 'برش عرضی (عرض ورق در جهت طول کویل)';
                cuttingPattern = `تعداد ورق در طول: ${sheets2_length} - تعداد ورق در عرض: ${sheets2_width}`;
            }

            // نمایش نتایج
            document.getElementById('coilLength').textContent = coilLengthM.toFixed(2) + ' متر';
            document.getElementById('sheetsCount').textContent = bestOption.sheets + ' ورق';
            document.getElementById('wastePercentage').textContent = bestOption.waste.toFixed(2) + '%';
            document.getElementById('usefulArea').textContent = (bestOption.usedArea / 1000000).toFixed(2) + ' متر مربع';
            
            document.getElementById('cuttingDirection').textContent = `جهت برش: ${cuttingDirection}`;
            document.getElementById('cuttingPattern').textContent = `الگوی برش: ${cuttingPattern}`;
            
            let optimizationTips = '';
            if (bestOption.waste > 20) {
                optimizationTips = 'توصیه: ضایعات بالا است. بررسی ابعاد ورق یا تغییر ابعاد کویل توصیه می‌شود.';
            } else if (bestOption.waste > 10) {
                optimizationTips = 'توصیه: ضایعات متوسط است. می‌توان بهینه‌سازی بیشتری انجام داد.';
            } else {
                optimizationTips = 'عالی! ضایعات کم است و برش بهینه انجام می‌شود.';
            }
            
            document.getElementById('optimizationTips').textContent = optimizationTips;

            // نمایش نمودار برش
            createCuttingDiagram(bestOption.lengthSheets, bestOption.widthSheets);
            
            // نمایش بخش نتایج
            document.getElementById('resultsSection').style.display = 'block';
        }

        function createCuttingDiagram(lengthSheets, widthSheets) {
            const container = document.getElementById('diagramContainer');
            container.innerHTML = '';

            const visualization = document.createElement('div');
            visualization.className = 'coil-visualization';

            // محدود کردن نمایش به حداکثر 10x10 برای قابلیت مشاهده
            const maxDisplay = 10;
            const displayLengthSheets = Math.min(lengthSheets, maxDisplay);
            const displayWidthSheets = Math.min(widthSheets, maxDisplay);

            for (let i = 0; i < displayWidthSheets; i++) {
                const row = document.createElement('div');
                row.className = 'coil-row';
                
                for (let j = 0; j < displayLengthSheets; j++) {
                    const piece = document.createElement('div');
                    piece.className = 'sheet-piece';
                    piece.textContent = (i * displayLengthSheets + j + 1).toString();
                    row.appendChild(piece);
                }
                
                visualization.appendChild(row);
            }

            // اضافه کردن توضیحات
            const description = document.createElement('div');
            description.style.marginTop = '10px';
            description.style.textAlign = 'center';
            description.style.color = '#666';
            description.innerHTML = `
                <p>نمایش ${displayLengthSheets} × ${displayWidthSheets} از ${lengthSheets} × ${widthSheets} ورق</p>
                <p>هر مربع نشان‌دهنده یک ورق است</p>
            `;

            container.appendChild(visualization);
            container.appendChild(description);
        }
    </script>
</body>
</html>